<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/mypage.css">
</head>
<body>
<div th:if="${userProfile != null}" data-username="${userProfile.username}">
    <form class="showMyPage" th:action="@{/mypage/modify}" method="post">
        <span class="label">
            <label class="input" for="username">아이디:</label>
            <input class="answer" type="text" id="username" name="username"
                   readonly th:value="${userProfile.username}"/>
        </span>

        <!--비밀번호 변경-->
        <span class="label">
            <label class="input" for="password">비밀번호:</label>
            <input class="answer" type="password" id="password" name="password"
                   readonly th:value="${userProfile.password}" style="background-color: #f8f9fa; color: #f8f9fa;"/>
            <button class="btn-outline-danger" type="button" onclick="enablePasswordChangeForm()">변경</button>
        </span>
        <span class="label" id="passwordChangeForm" style="display: none;">
            <label class="input" for="newPassword">새로운 비밀번호:</label>
            <input class="answer" type="password" id="newPassword" name="newPassword"/>
            <button class="btn-outline-danger" type="button" onclick="saveNewPassword()">저장</button>
            <p id="passwordErrorMessage" style="color: red;"></p>
            <p id="passwordSuccessMessage" style="color: green;"></p>
        </span>

        <span class="label">
            <label class="input" for="name">이름:</label>
            <input class="answer" type="text" id="name" name="name"
                   readonly th:value="${userProfile.name}"/>
        </span>


        <!--이메일 변경-->
        <span class="label">
            <label class="input" for="email">이메일:</label>
            <input class="answer" type="email" id="email" name="email"
                   readonly th:value="${userProfile.email}"/>
            <button class="btn-outline-danger" type="button" onclick="enableEmailChangeForm()">변경</button>
        </span>
        <span class="label" id="emailChangeForm" style="display: none;">
            <label class="input" for="newEmailAddress">새로운 이메일:</label>
            <input class="answer" type="text" id="newEmailAddress" name="newEmailAddress"/>
            <button class="btn-outline-danger" type="button" onclick="sendConfirmationCode()">인증 코드 전송</button>
            <p id="EmailErrorMessage" style="color: red;"></p>
            <p id="EmailSuccessMessage" style="color: green;"></p>
        </span>
        <span class="label" id="confirmationCodeForm" style="display: none;">
            <label class="input" for="confirmationCode">인증 코드:</label>
            <input class="answer" type="text" id="confirmationCode" name="confirmationCode"/>
            <button class="btn-outline-danger" type="button" onclick="verifyEmailAddress()">인증 코드 확인</button>
            <p id="ConfirmationCodeErrorMessage" style="color: red;"></p>
            <p id="ConfirmationCodeSuccessMessage" style="color: green;"></p>
        </span>

        <span class="label">
            <label class="input" for="registDate">가입일:</label>
            <input class="answer" type="text" id="registDate" name="registDate"
                   readonly th:value="${#temporals.format(userProfile.registDate, 'yyyy년 MM월 dd일')}"/>
        </span>
    </form>
</div>

<div th:if="${userProfile == null}">
    <p>사용자 프로필을 찾을 수 없습니다.</p>
</div>

<script src="/js/mypage.js"></script>
</body>
</html>
